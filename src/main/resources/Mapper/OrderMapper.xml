<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ls.springmvc.dao.OrderDao">

    <select id="pageSearch"  resultType="com.ls.springmvc.vo.Order">
        select * from `order`
    </select>
    <!-- 根据id查询资源 -->
    <select id="findOrderById" parameterType="Integer" resultType="com.ls.springmvc.vo.Order">
        select * from `order` where orderid = #{orderid}
    </select>

    <!-- 更新资源状态 -->
    <update id="changeOrderStatus" parameterType="com.ls.springmvc.vo.Order">
        UPDATE `order` SET orderstatus = #{status} WHERE orderid = #{orderId}
    </update>


    <!-- 插入订单 -->
    <insert id="insert" parameterType="com.ls.springmvc.vo.Order"
            useGeneratedKeys="true" keyProperty="orderid">
        INSERT INTO `order` (taskid,resourceids,totalprice,quantity,orderstatus,ordertime,userid)
        VALUES (#{taskid},#{resourceids},#{totalprice},#{quantity},#{orderstatus},#{ordertime},#{userid})
    </insert>

    <!-- 条件查询订单 -->
    <select id="selectByCondition" resultType="com.ls.springmvc.vo.Resource" >
        SELECT * FROM `order`
        <where>
            <if test="orderid != null">AND orderid = #{orderid}</if>
            <if test="userid != null">AND userid = #{userid}</if>
            <if test="status != null">AND orderstatus = #{status}</if>
        </where>
        ORDER BY ordertime DESC
    </select>
</mapper>